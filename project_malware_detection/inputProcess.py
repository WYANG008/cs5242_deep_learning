import csv
import numpy as np

def getData(filename):
    with open(filename, "rb") as csvfile:
        datareader = csv.reader(csvfile)
        count = 0
        for row in datareader:
            
            
            if len(row) < 4096 :
                maxValue = max(row)
                minValue = min(row)
                row = np.asarray(row)
                interm = np.zeros(4096)
                interm[:row.size] = row
                row = interm
            if len(row) > 4096:
                maxValue = max(row[:4096])
                minValue = min(row[:4096])
                row = np.asarray(row)
                row =row[:4096]
                
                count = count + 1
            yield (row, maxValue, minValue)
            

if __name__ == "__main__":
    data = []
    path = "data/test.csv"
    count =0
    min_num = 0
    max_num = 0

    for row, maxValue , minValue in getData(path):
        # print(row.max(axis=0))
        if (maxValue > max_num):
            max_num = maxValue
        if (minValue < min_num):
            min_num = minValue
        count = count +1
    print(min_num, max_num, count)
        # count = count +1
        # if count <10:
        #     print(row)
    #     data.append(row)
    # data = np.asarray(data)
            # print(b)
   
